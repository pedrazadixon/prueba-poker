<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prueba Poker</title>
    <link
      rel="stylesheet"
      href="http:////cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css"
    />
    <script src="http:////code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="http:////cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>

    <style>
      body {
        height: 90vh;
        display: flex;
      }

      #tablaPoker {
        width: 100%;
      }

      .dataTables_wrapper {
        width: 100%;
        padding-left: 5px;
        padding-right: 5px;
      }
    </style>
  </head>
  <body>
    <textarea id="numeros_aleatorios" rows="6">
        0.546548975
        0
        0.4865315
        0.44
        0.25486
    </textarea>

    <button onclick="procesar()">run</button>

    <table id="tablaPoker">
      <thead>
        <tr>
          <th>Numeros Aleatorios</th>
          <th>Procesado</th>
          <th>Categoria</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      var evaluar = function (numero) {
        var valor_recortado = numero.substring(2, 7);

        if (valor_recortado.length < 5) {
          var ceros_faltantes = 5 - valor_recortado.length;
          for (let k = 1; k <= ceros_faltantes; k++) {
            valor_recortado = valor_recortado + "0";
          }
        }

        var conteos = {};

        for (let i = 0; i < valor_recortado.length; i++) {
          const element = valor_recortado[i];

          conteos[valor_recortado[i]] =
            valor_recortado.split(valor_recortado[i]).length - 1;
        }

        var pares = 0;
        var tercias = 0;
        var poker = 0;
        var quitillas = 0;
        var diferentes = 0;

        for (const propiedad in conteos) {
          if (conteos[propiedad] == 1) diferentes++;
          if (conteos[propiedad] == 2) pares++;
          if (conteos[propiedad] == 3) tercias++;
          if (conteos[propiedad] == 4) poker++;
          if (conteos[propiedad] == 5) quitillas++;
        }

        if (poker == 1)
          return { valor_procesado: valor_recortado, categoria: "POKER" };

        if (quitillas == 1)
          return { valor_procesado: valor_recortado, categoria: "1Q" };

        if (diferentes == 5)
          return { valor_procesado: valor_recortado, categoria: "TD" };

        if (pares == 2)
          return { valor_procesado: valor_recortado, categoria: "2P" };

        if (pares == 1 && tercias == 1)
          return { valor_procesado: valor_recortado, categoria: "FULL" };

        if (pares == 1 && diferentes == 3)
          return { valor_procesado: valor_recortado, categoria: "1P" };

        if (tercias == 1 && diferentes == 2)
          return { valor_procesado: valor_recortado, categoria: "1T" };
      };

      var procesar = function () {
        var tableData = [];

        $("#tablaPoker").DataTable().destroy();

        var lineas = $("#numeros_aleatorios").val().split("\n");
        for (var i = 0; i < lineas.length; i++) {
          var valor = lineas[i].trim();
          if (valor !== "") {
            var procesado = evaluar(valor);

            tableData.push({
              numero_aleatorio: valor,
              numero_procesado: procesado.valor_procesado,
              categoria: procesado.categoria,
            });
          }
        }

        $("#tablaPoker").DataTable({
          paging: false,
          // bInfo: false,
          ordering: false,
          data: tableData,
          columns: [
            { data: "numero_aleatorio" },
            { data: "numero_procesado" },
            { data: "categoria" },
          ],
        });
      };
    </script>
  </body>
</html>
